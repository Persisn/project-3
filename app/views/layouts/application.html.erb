<!DOCTYPE html>
<html>
  <head>
    <title>SmartestMart</title>
    <%= csrf_meta_tags %>
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body class="stocks show" style="background-color:#FAF3E7">
    <nav class="navbar navbar-expand-lg navbar-light" style="background-color:#FF946D ;">
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
  <a class="navbar-brand" id= "mainTitle" href="/" style= "color:#683C2D">Smart Mart</a>
  <div class="collapse navbar-collapse" id="navbarTogglerDemo01" >
    <ul class="nav navbar-nav pull-sm-left" >
      <%# <li class="nav-item nav-link"> %><%= link_to "Start shopping", stocks_path, class: "btn", method: :get, style: "color:#FF946D; background-color:#FAF3E7;" %><%# </li> %>
    </ul>
    <ul class="nav navbar-nav mx-auto">
      <%= form_tag(stocks_path, :id => 'search', method: :get) do %>
      <%= hidden_field_tag :button , "searching" %>
      <%= text_field_tag :term, params[:term], placeholder: "Enter keyword or barcode", style: "display: inline;", size: 40%>
      <%= submit_tag 'Search', class: "btn", name: nil, style: "color:#FF946D; background-color:#FAF3E7;" %>
      <% end %>
      <%= button_to 'Barcode', stocks_show_path, class: "btn ", method: :get, style: "color:#FF946D; background-color:#FAF3E7;" %>
    </ul>
    <ul class ="nav navbar-nav pull-sm-right">
      <% unless user_signed_in? %>
        <li class="nav-item nav-link"><%= link_to "Login", new_user_session_path %></li>
        <li class="nav-item nav-link"><%= link_to "Register", new_user_registration_path %></li>
      <% else %>
      <div class="dropdown show">
        <a class="btn nav-link dropdown-toggle" href="/edit" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color:#FAF3E7;">
          Shopping Lists
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
          <li class="dropdown-item"><%= link_to "Overview", user_shoppinglists_path(current_user) %></li>
          <h6 class="dropdown-header">Active Lists</h6>
          <div class="dropdown-divider"></div>
          <% current_user.shoppinglists.each do |shoppinglist| %>
            <% if !shoppinglist.paid_on %>
              <li class="dropdown-item"><%= link_to shoppinglist.name_shoppinglist, user_shoppinglist_path(current_user, shoppinglist.id) %></li>
            <% end %>
          <% end %>
          <% if current_user.shoppinglists.where(:paid_on=> nil).count==0 || current_user.shoppinglists.empty? %>
            <li class="dropdown-item">You have no List, Please <%= link_to "create", user_shoppinglists_path(current_user) %> one.</li>
          <% end %>
        </div>
      </div>
      <div class="dropdown show">
        <a class="btn nav-link dropdown-toggle" href="/edit" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color:#FAF3E7;">
          <%= current_user.name %>
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
          <li class="dropdown-item"><%= link_to "Edit Profile", edit_user_registration_path(current_user) %></li>
          <li class="dropdown-item"><%= link_to "Transaction History", user_shoppinglist_history_path(current_user) %></li>
          <div class="dropdown-divider"></div>
          <li class="dropdown-item">
            <%= link_to "Logout", destroy_user_session_path, method: :delete %>
          </li>
        </div>
      </div>
      <% end %>
    </ul>
  </div>
</nav>
<!-- start of content -->
    <div class="container" >
      <% flash.each do |key, value| %>
        <div class="alert alert-<%= key %>"><%= raw(value) %></div>
      <% end %>
    <%= yield %>
    </div>
    <%# <footer class="navbar fixed-bottom navbar-expand navbar-dark bg-dark">
        <div class="container-fluid p-0 p-md-2">
          <p class="text-center">Put together by <a href="https://github.com/imjustlooking" target="_blank" rel="noopener">Gab's angels</a>, with <a href="http://getbootstrap.com/" target="_blank">Bootstrap 4</a> </p>
        </div>
    </footer>  TODO: Footer to be adjusted%>

  </body>
</html>
